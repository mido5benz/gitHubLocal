<div class="tourDetail">
    <div class="card">

        <app-tour-card-header [tourDetails]="tourDetails" [fmCounts]="fmcountVar"></app-tour-card-header>

        <ngx-pull-to-refresh spinnerColor="#f27e00" distanceForRefresh="40" [isEnable]="true"
            (refresh)="myRefreshEvent($event, 'refresh')" style="display:block;height:100%;">

            <div class="card-body">
                <div class="item-list" id="swipeableContainer">
                    <div class="item" *ngFor="let item of tourarray;let index = index"
                        (swipeleft)="onSwipe(index,$event)" (swiperight)="onSwipe(-1,$event)"
                        [ngClass]="[index == temp ? 'demo' : 'leftz',item.showFM == false ? 'fmHide' : 'fmShow']">
                        <div class="itemValuesContainer">
                            <div class="row-header" [ngClass]="index == ellipsis ? 'longnumber' : 'smllnumber'"
                                [style.color]="item.eventColor" (click)="iconClick(item)">
                                <i class=""
                                    [ngClass]="[item.icon == 'deficite-amount' ? 'fa fa-money-bill-alt' : (item.icon == 'dolly' ? 'fa fa-dolly':(item.icon == 'fehlMenge' ? 'fehlMengeClass' : item.icon)),item.icon == 'fehlMenge' ? 'icon1' : 'icon']"
                                    *ngIf="item.icon"></i>
                                <span class="icon-text" *ngIf="item.icon == 'dolly'"
                                    [style.color]="item.eventColor">{{item.tourNr}}</span>
                            </div>
                            <div class="row-body-id" [ngClass]="index == ellipsis ? 'longnumber' : 'smllnumber'"
                                (click)="shipmentDetails(item)">{{item.colliBarcode ?
                                item.colliBarcode:'&nbsp;'}}
                            </div>
                            <div class="lang-reference" [ngClass]="index == ellipsis ? 'longnumber' : 'smllnumber'">
                                <span *ngIf="ellipsis !== index" (click)="onEllipsis(index)">
                                    {{item.langreferenz ? (item.langreferenz.length>6 ? (item.langreferenz
                                    | slice:0:6)+'..': item.langreferenz) : '&nbsp;' }}&nbsp;&nbsp;&nbsp;&nbsp;
                                </span>
                                <span *ngIf="ellipsis == index" (click)="onEllipsis(-1)">
                                    {{item.langreferenz ?item.langreferenz:'&nbsp;'}}
                                </span>
                            </div>
                            <div class="row-body-address" [ngClass]="index == ellipsis ? 'longnumber' : 'smllnumber'"
                                (click)="shipmentDetails(item)">{{item.recipientAdress ?
                                item.recipientAdress : '&nbsp;' }}
                            </div>
                            <div class="row-body-arrow">
                                &nbsp;&nbsp;<a *ngIf="temp != index" (click)="arrowClick(index)"><i
                                        class="fa fa-chevron-left fa-2x"></i></a>&nbsp; &nbsp;&nbsp;
                                <a *ngIf="temp == index" (click)="arrowClick(-1)">
                                    <i class="fa fa-chevron-right fa-2x"></i></a>&nbsp;
                            </div>
                        </div>

                        <div class="action action-3" >
                            <button class="d-inline-block gray-background"
                                (click)="bracodeMethod(item,scanHistoryTemplate)">
                                <i class="fa fa-barcode"></i>
                            </button>
                            <button class="d-inline-block red-background" (click)="fmMethod(item,fmModaltemplate)" [ngClass]="test(item) ? 'customDisabled':''"
                            *ngIf="item.showFM == false ? false : true">FBB</button>
                        </div>
                    </div>
                </div>
            </div>
        </ngx-pull-to-refresh>
    </div>
</div>

<div class="tourDetailsSelectionLoader"></div>

<ng-template #scanHistoryTemplate>
    <div class="modal-header">
        <h4 class="modal-title pull-left">Scanhistorie</h4>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <div class="scanHistoryTableContainer">
            <app-static-table [columns]='scanHistory.columns' [data]='scanHistory.data'></app-static-table>
        </div>
    </div>
</ng-template>


<ng-template #fmModaltemplate>
    <div class="modal-header p-3">
        <h4 class="modal-title">Fehlmeldung schreiben...</h4>
    </div>
    <div class="modal-body p-3">
        <div class="container-fluid">
            {{fmModalMessage}}
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary text-capitalize btsm" (click)="fmConfirm()">Ja</button>
        <button type="button" class="btn btn-primary text-capitalize btsm" (click)="fmCancel()">Nein</button>
    </div>
</ng-template>
